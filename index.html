<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Pixel Rogue RPG</title>
<style>
body{margin:0;font-family:sans-serif;text-align:center;}
.day{background:#f2f2f2;color:black;}
.night{background:#111;color:white;}
#gameBox{width:900px;margin:20px auto;border:2px solid #555;padding:10px;}
.panel{border:1px solid #444;padding:8px;margin:6px;}
button{font-size:16px;margin:4px;}
.hidden{display:none;}
</style>
</head>

<body class="day">

<!-- ì‹œì‘ í™”ë©´ -->
<div id="startUI">
<h2>ìŠ¤íƒ¯ ë¶„ë°° (12)</h2>

ìŠ¤í”¼ë“œ <span id="spd">0</span>
<button onclick="stat('spd',1)">+</button>
<button onclick="stat('spd',-1)">-</button><br>

ì²´ë ¥ <span id="hpStat">0</span>
<button onclick="stat('hp',1)">+</button>
<button onclick="stat('hp',-1)">-</button><br>

ê³µê²© <span id="atkStat">0</span>
<button onclick="stat('atk',1)">+</button>
<button onclick="stat('atk',-1)">-</button><br>

ë‚¨ì€ í¬ì¸íŠ¸ <span id="pt">12</span><br><br>
<button onclick="startGame()">ê²Œì„ ì‹œì‘</button>
</div>

<!-- ê²Œì„ í™”ë©´ -->
<div id="gameBox" class="hidden">

<h3>
<span id="dayUI">ğŸŒ DAY</span> |
ìƒì¡´ ì¼ìˆ˜: <span id="dayCount">1</span>
</h3>

<div class="panel">
<b>PLAYER</b><br>
HP <span id="pHp"></span> /
ATK <span id="pAtk"></span> /
SPD <span id="pSpd"></span>
</div>

<div class="panel">
<b>MONSTER</b><br>
<span id="mInfo">ì—†ìŒ</span>
</div>

<div class="panel">
<b>INVENTORY</b><br>
Gold: <span id="goldUI">0</span><br>
ë‚˜ë­‡ê°€ì§€: <span id="stickUI">0</span><br>
<button onclick="useStick()">ë‚˜ë­‡ê°€ì§€ ì‚¬ìš©</button>
</div>

<div id="battleLog">ì´ë™í•´ë³´ì</div>

<button onclick="move()">ì´ë™</button>

<!-- ì „íˆ¬ -->
<div id="battleUI" class="hidden">
<button onclick="playerAttack()">âš”ï¸ ê³µê²©</button>
<button onclick="escape()">ğŸƒ ë„ë§</button>
</div>

<!-- ìƒì -->
<div id="chestUI" class="hidden">
<button onclick="openChest()">ì—´ê¸°</button>
<button onclick="leaveChest()">ë„ë§</button>
</div>

<br><br>
<button style="margin-top:30px;" onclick="resetGame()">ì²˜ìŒìœ¼ë¡œ</button>
</div>

<!-- íŒ¨ë°° -->
<div id="gameOverUI" class="hidden">
<h1>ğŸ’€ íŒ¨ë°°</h1>
<button onclick="resetGame()">ë‹¤ì‹œ ì‹œì‘</button>
</div>

<script>
/* ===== ê¸°ë³¸ ===== */
let stats={spd:0,hp:0,atk:0}, statPt=12;
let player, monster=null;
let isDay=true, turn=0, surviveDay=1;
let inBattle=false, chestWaiting=false;

let gold=0;
let sticks=0;
let activeSticks=[];

/* ===== ìŠ¤íƒ¯ ===== */
function stat(k,v){
 if(statPt-v<0||stats[k]+v<0) return;
 stats[k]+=v; statPt-=v;
 spd.innerText=stats.spd;
 hpStat.innerText=stats.hp;
 atkStat.innerText=stats.atk;
 pt.innerText=statPt;
}

function startGame(){
 if(stats.hp<=0) return alert("ì²´ë ¥ì€ 1 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤!");
 if(statPt>0) return alert("í¬ì¸íŠ¸ë¥¼ ë‹¤ ì¨ì•¼ í•©ë‹ˆë‹¤!");
 player={hp:stats.hp,atk:stats.atk,spd:stats.spd};
 startUI.classList.add("hidden");
 gameBox.classList.remove("hidden");
 updateUI();
}

/* ===== ì´ë™ ===== */
function move(){
 if(inBattle||chestWaiting) return;
 Math.random()<0.6 ? spawnMonster() : findChest();
}

/* ===== ìƒì ===== */
function findChest(){
 chestWaiting=true;
 log("ìƒìë¥¼ ë°œê²¬í–ˆë‹¤!");
 chestUI.classList.remove("hidden");
}

function openChest(){
 chestWaiting=false;
 chestUI.classList.add("hidden");
 let dice=Math.floor(Math.random()*6)+1;

 if(dice<=2){
  if(sticks>=3) log("ë‚˜ë­‡ê°€ì§€ë¥¼ ë” ë“¤ ìˆ˜ ì—†ë‹¤!");
  else{sticks++; log("ë‚˜ë­‡ê°€ì§€ íšë“!");}
 }
 else if(dice<=4){
  gold++; log("ê³¨ë“œ +1");
 }
 else{
  monster={hp:1,atk:1,spd:99};
  inBattle=true;
  battleUI.classList.remove("hidden");
  log("ë¯¸ë¯¹ì´ë‹¤!");
  if(monster.spd>player.spd) monsterAttack();
 }
 updateUI();
}

function leaveChest(){
 chestWaiting=false;
 chestUI.classList.add("hidden");
 log("ìƒìë¥¼ ë¬´ì‹œí–ˆë‹¤.");
}

/* ===== ëª¬ìŠ¤í„° ===== */
function spawnMonster(){
 monster={
  hp: isDay?6:8,
  atk: isDay?2:3,
  spd: isDay?1:2
 };
 inBattle=true;
 battleUI.classList.remove("hidden");
 log("ëª¬ìŠ¤í„° ë“±ì¥!");
 if(monster.spd>player.spd) monsterAttack();
 updateUI();
}

/* ===== ì „íˆ¬ ===== */
function playerAttack(){
 monster.hp-=player.atk;
 if(monster.hp<=0) return win();
 monsterAttack();
}

function monsterAttack(){
 player.hp-=monster.atk;
 if(player.hp<=0) return gameOver();
 updateUI();
}

function escape(){
 let dice=Math.floor(Math.random()*6)+1;
 log("ë„ë§ ì‹œë„ ğŸ² "+dice);
 if(dice<=4){log("ë„ë§ ì‹¤íŒ¨!"); monsterAttack();}
 else win(true);
}

function win(escaped=false){
 monster=null;
 inBattle=false;
 battleUI.classList.add("hidden");
 processStickTurns();

 turn++;
 if(turn>=5){
  turn=0;
  if(isDay) isDay=false;
  else{ isDay=true; surviveDay++; }
 }

 log(escaped?"ë„ë§ ì„±ê³µ!":"ìŠ¹ë¦¬!");
 updateUI();
}

/* ===== ë‚˜ë­‡ê°€ì§€ ===== */
function useStick(){
 if(sticks<=0) return;
 sticks--;
 player.atk++;
 activeSticks.push({turns:3});
 log("ê³µê²© +1 (3í„´)");
 updateUI();
}

function processStickTurns(){
 activeSticks.forEach(s=>s.turns--);
 let before=activeSticks.length;
 activeSticks=activeSticks.filter(s=>s.turns>0);
 let removed=before-activeSticks.length;
 if(removed>0){ player.atk-=removed; log("ë‚˜ë­‡ê°€ì§€ íš¨ê³¼ ì¢…ë£Œ"); }
}

/* ===== UI ===== */
function updateUI(){
 document.body.className=isDay?"day":"night";
 dayUI.innerText=isDay?"ğŸŒ DAY":"ğŸŒ™ NIGHT";
 dayCount.innerText=surviveDay;

 pHp.innerText=player.hp;
 pAtk.innerText=player.atk;
 pSpd.innerText=player.spd;

 mInfo.innerText=monster?
  `HP ${monster.hp} / ATK ${monster.atk} / SPD ${monster.spd}`:"ì—†ìŒ";

 goldUI.innerText=gold;
 stickUI.innerText=sticks;
}

function log(t){battleLog.innerText=t;}
function gameOver(){
 gameBox.classList.add("hidden");
 gameOverUI.classList.remove("hidden");
}
function resetGame(){location.reload();}
</script>
</body>
</html>
