<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Pixel Rogue RPG</title>
<style>
body {
  margin: 0;
  background: #111;
  color: white;
  font-family: sans-serif;
  text-align: center;
}
canvas {
  background: black;
  display: block;
  margin: auto;
  border: 2px solid #555;
}
button {
  font-size: 18px;
  margin: 5px;
}
#controlUI button {
  font-size: 26px;
  width: 60px;
  height: 60px;
}
</style>
</head>
<body>

<h2 id="title">ìŠ¤íƒ¯ ë¶„ë°° (ì´ 12)</h2>

<div id="statUI">
  ìŠ¤í”¼ë“œ: <span id="speed">0</span>
  <button onclick="changeStat('speed',1)">+</button>
  <button onclick="changeStat('speed',-1)">-</button><br>

  ì²´ë ¥: <span id="hp">0</span>
  <button onclick="changeStat('hp',1)">+</button>
  <button onclick="changeStat('hp',-1)">-</button><br>

  ê³µê²©: <span id="atk">0</span>
  <button onclick="changeStat('atk',1)">+</button>
  <button onclick="changeStat('atk',-1)">-</button><br>

  <p>ë‚¨ì€ í¬ì¸íŠ¸: <span id="points">12</span></p>
  <button onclick="startGame()">ê²Œì„ ì‹œì‘</button>
</div>

<canvas id="game" width="900" height="600" style="display:none;"></canvas>

<div id="battleUI" style="display:none;">
  <button onclick="playerAttack()">ê³µê²©</button>
</div>

<div id="controlUI" style="display:none;">
  <button onclick="move('up')">â¬†ï¸</button><br>
  <button onclick="move('left')">â¬…ï¸</button>
  <button onclick="move('down')">â¬‡ï¸</button>
  <button onclick="move('right')">â¡ï¸</button>
</div>

<script>
/* =====================
   ê¸°ë³¸ ë°ì´í„°
===================== */
let totalPoints = 12;

let player = {
  speed: 0,
  atk: 0,
  maxHp: 0,
  hp: 0
};

let monster = {};
let phaseTurn = 1; // ë‚®/ë°¤ ì•ˆì—ì„œì˜ í„´
let isDay = true;
let playerTurn = true;

/* =====================
   ìº”ë²„ìŠ¤
===================== */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

/* =====================
   ìŠ¤íƒ¯ ë¶„ë°°
===================== */
function changeStat(stat, value) {
  if (value > 0 && totalPoints === 0) return;
  if (value < 0 && player[stat] === 0) return;

  player[stat] += value;
  totalPoints -= value;

  document.getElementById(stat === 'speed' ? 'speed' : stat).innerText = player[stat];
  document.getElementById('points').innerText = totalPoints;
}

function startGame() {
  if (totalPoints !== 0) {
    alert("í¬ì¸íŠ¸ë¥¼ ëª¨ë‘ ì‚¬ìš©í•˜ì„¸ìš”!");
    return;
  }

  player.maxHp = player.hp * 10;
  player.hp = player.maxHp;

  document.getElementById("statUI").style.display = "none";
  document.getElementById("title").style.display = "none";
  canvas.style.display = "block";
  document.getElementById("battleUI").style.display = "block";
  document.getElementById("controlUI").style.display = "block";

  spawnMonster();
  draw();
}

/* =====================
   ëª¬ìŠ¤í„° ìƒì„±
===================== */
function spawnMonster() {
  monster = {
    maxHp: isDay ? 30 : 50,
    hp: isDay ? 30 : 50,
    atk: isDay ? 5 : 10
  };
  playerTurn = true;
}

/* =====================
   ì „íˆ¬ (í„´ì œ)
===================== */
function playerAttack() {
  if (!playerTurn) return;

  monster.hp -= player.atk;
  playerTurn = false;

  if (monster.hp <= 0) {
    endBattle();
    return;
  }

  setTimeout(monsterAttack, 500);
}

function monsterAttack() {
  player.hp -= monster.atk;
  playerTurn = true;

  if (player.hp <= 0) {
    alert("ê²Œì„ ì˜¤ë²„");
    location.reload();
  }

  draw();
}

function endBattle() {
  phaseTurn++;

  if (phaseTurn > 5) {
    isDay = !isDay;
    phaseTurn = 1;
  }

  spawnMonster();
  draw();
}

/* =====================
   ë°©í–¥ ë²„íŠ¼ (ì§€ê¸ˆì€ ë¡œê·¸ë§Œ)
===================== */
function move(dir) {
  console.log("ë°©í–¥ ì…ë ¥:", dir);
}

/* =====================
   í™”ë©´ ê·¸ë¦¬ê¸°
===================== */
function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  ctx.fillStyle = "white";
  ctx.font = "20px Arial";
  ctx.fillText(isDay ? "ğŸŒ DAY" : "ğŸŒ™ NIGHT", 20, 30);
  ctx.fillText("í„´: " + phaseTurn + " / 5", 20, 60);

  // ëª¬ìŠ¤í„°
  ctx.fillStyle = "red";
  ctx.fillRect(400, 120, 100, 100);
  ctx.fillText("ëª¬ìŠ¤í„° HP: " + monster.hp, 380, 100);

  // í”Œë ˆì´ì–´
  ctx.fillStyle = "blue";
  ctx.fillRect(400, 350, 100, 100);
  ctx.fillText("í”Œë ˆì´ì–´ HP: " + player.hp, 360, 480);
}
</script>

</body>
</html>
