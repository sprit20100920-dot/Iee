<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Rogue RPG</title>

<style>
body{font-family:sans-serif;text-align:center;margin:0}
.day{background:#f5f5f5;color:#000}
.night{background:#111;color:#fff}
.hidden{display:none}
#game{width:900px;margin:auto;border:2px solid #444;padding:10px}
.panel{border:1px solid #666;margin:6px;padding:6px}
button{font-size:15px;margin:4px}
.select{border:2px solid red}
.red{color:red;font-weight:bold}
</style>
</head>

<body class="day">

<!-- ì‹œì‘ -->
<div id="startUI">
<h2>ìŠ¤íƒ¯ ë¶„ë°° (ì´ 10)</h2>

SPD <span id="spd">0</span>
<button id="spdPlus">+</button>
<button id="spdMinus">-</button><br>

HP <span id="hp">0</span>
<button id="hpPlus">+</button>
<button id="hpMinus">-</button><br>

ATK <span id="atk">0</span>
<button id="atkPlus">+</button>
<button id="atkMinus">-</button><br>

ë‚¨ì€ í¬ì¸íŠ¸ <span id="pt">10</span><br><br>
<button id="startBtn">ê²Œì„ ì‹œì‘</button>
</div>

<!-- ê²Œì„ -->
<div id="game" class="hidden">

<h3><span id="timeUI">ğŸŒ DAY</span> | ìƒì¡´ <span id="dayUI">1</span>ì¼</h3>

<div class="panel">
<b>PLAYER</b><br>
HP <span id="pHp"></span>
ATK <span id="pAtk"></span>
SPD <span id="pSpd"></span>
</div>

<div class="panel">
<b>MONSTER</b><br>
<span id="mInfo">ì—†ìŒ</span>
</div>

<div class="panel">
<b>INVENTORY</b><br>
Gold: <span id="goldUI">0</span><br>
Ruby: <span id="rubyUI">0</span><br>
<span id="invUI">ì—†ìŒ</span><br>
<button id="invBtn">ì¸ë²¤í† ë¦¬</button>
</div>

<div id="log">ì´ë™í•˜ì</div>
<button id="moveBtn">ì´ë™</button>

<div id="battleUI" class="hidden">
<button id="atkBtn">ê³µê²©</button>
<button id="escBtn">ë„ë§</button>
</div>

<div id="boxUI" class="hidden">
<button id="openBoxBtn">ì—´ê¸°</button>
<button id="closeBoxBtn">ë„ë§</button>
</div>

<div id="inventoryUI" class="hidden">
<h3>ì¸ë²¤í† ë¦¬</h3>
<div id="invSelect"></div>
<button id="useItemBtn">ì‚¬ìš©</button>
<button id="closeInvBtn">ë‹«ê¸°</button><br>
<button id="leftBtn">â—€</button>
<button id="rightBtn">â–¶</button>
</div>

<button style="margin-top:30px" onclick="location.reload()">ì²˜ìŒìœ¼ë¡œ</button>
</div>

<div id="deadUI" class="hidden">
<h1>â˜ ï¸ ì‚¬ë§</h1>
<div id="deadInfo"></div>
<button onclick="location.reload()">ë‹¤ì‹œ ì‹œì‘</button>
</div>

<script>
/* ===== DOM ===== */
const spdUI=spd, hpUI=hp, atkUI=atk, ptUI=pt;

/* ===== ìŠ¤íƒ¯ ===== */
let stats={spd:0,hp:0,atk:0}, pt=10;
function updateStatUI(){
 spdUI.textContent=stats.spd;
 hpUI.textContent=stats.hp;
 atkUI.textContent=stats.atk;
 ptUI.textContent=pt;
}
function addStat(t,v){
 if(v>0 && pt<=0) return;
 if(v<0 && stats[t]<=0) return;
 stats[t]+=v; pt-=v; updateStatUI();
}
spdPlus.onclick=()=>addStat("spd",1);
spdMinus.onclick=()=>addStat("spd",-1);
hpPlus.onclick=()=>addStat("hp",1);
hpMinus.onclick=()=>addStat("hp",-1);
atkPlus.onclick=()=>addStat("atk",1);
atkMinus.onclick=()=>addStat("atk",-1);

/* ===== ê²Œì„ ìƒíƒœ ===== */
let player, monster=null;
let gold=0, ruby=0;
let day=1, isDay=true, turn=0;
let items={branch:{count:0,turns:[]}};

/* ===== ì•„ì´í…œ ===== */
const itemData={
 sword:{name:"ì² ê²€",type:"weapon",atk:1},
 shield:{name:"ë‚¡ì€ ë°©íŒ¨",type:"shield",hp:1},
 armor:{name:"ì²  ê°‘ì˜·",type:"armor",hp:2},
 earring:{name:"ê°’ì‹¼ ê·€ê±¸ì´",type:"accessory",spd:1},
 batWing:{name:"ë°•ì¥ë‚ ê°œ",type:"material"}
};
let inventory=[], equip={};

/* ===== ì‹œì‘ ===== */
startBtn.onclick=()=>{
 if(stats.hp<=0) return alert("ì²´ë ¥ì€ 1 ì´ìƒ!");
 player={...stats};
 startUI.classList.add("hidden");
 game.classList.remove("hidden");
 update();
};

/* ===== ì´ë™ ===== */
moveBtn.onclick=()=>{
 let rate=isDay?4/12:8/12;
 if(Math.random()<rate){spawnMonster();return;}
 findBox();
};

/* ===== ìƒì ===== */
let boxType=null;
function findBox(){
 boxType=Math.random()<0.3?"advanced":"normal";
 boxUI.classList.remove("hidden");
 log(boxType==="advanced"
  ? "<span class='red'>ğŸ”´ ê³ ê¸‰ ìƒì ë°œê²¬!</span>"
  : "ğŸ“¦ ìƒìë¥¼ ë°œê²¬í–ˆë‹¤!");
}
openBoxBtn.onclick=()=>{
 boxUI.classList.add("hidden");

 if(boxType==="normal"){
  let d=Math.floor(Math.random()*6)+1;
  if(d<=2 && items.branch.count<3){
   items.branch.count++; log("ğŸŒ¿ ë‚˜ë­‡ê°€ì§€ íšë“");
  }else if(d<=4){
   gold++; log("ğŸ’° ê³¨ë“œ íšë“");
  }else{
   spawnMimic(); return;
  }
 }

 if(boxType==="advanced"){
  if(ruby>=1) ruby--;
  else if(gold>=3) gold-=3;
  else{ log("âŒ ê³¨ë“œ3 ë˜ëŠ” ë£¨ë¹„1 í•„ìš”"); boxUI.classList.remove("hidden"); return; }

  const drop=["sword","shield","armor","earring"];
  let key=drop[Math.floor(Math.random()*drop.length)];
  inventory.push(key);
  log(`âœ¨ ${itemData[key].name} íšë“`);
 }
 boxType=null; update();
};
closeBoxBtn.onclick=()=>boxUI.classList.add("hidden");

/* ===== ì¸ë²¤ ===== */
let invList=[], invIndex=0;
invBtn.onclick=()=>{
 inventoryUI.classList.remove("hidden");
 invList=[...inventory];
 if(items.branch.count>0) invList.push("branch");
 invIndex=0; renderInv();
};
function renderInv(){
 invSelect.innerHTML="";
 invList.forEach((k,i)=>{
  let d=document.createElement("div");
  d.textContent=k==="branch"?"ë‚˜ë­‡ê°€ì§€":itemData[k].name;
  if(i===invIndex) d.className="select";
  invSelect.appendChild(d);
 });
}
leftBtn.onclick=()=>{if(invList.length){invIndex=(invIndex-1+invList.length)%invList.length;renderInv();}};
rightBtn.onclick=()=>{if(invList.length){invIndex=(invIndex+1)%invList.length;renderInv();}};
useItemBtn.onclick=()=>{
 let k=invList[invIndex];
 if(k==="branch"){
  items.branch.count--; player.atk++; log("ğŸŒ¿ ë‚˜ë­‡ê°€ì§€ ì‚¬ìš©");
 }else{
  let it=itemData[k];
  equip[it.type]=k;
  inventory.splice(inventory.indexOf(k),1);
  if(it.atk) player.atk+=it.atk;
  if(it.hp) player.hp+=it.hp;
  if(it.spd) player.spd+=it.spd;
  log(`ğŸ›¡ ${it.name} ì¥ì°©`);
 }
 inventoryUI.classList.add("hidden");
 update();
};
closeInvBtn.onclick=()=>inventoryUI.classList.add("hidden");

/* ===== ëª¬ìŠ¤í„° ===== */
function spawnMonster(){
 monster={name:"ë°•ì¥",hp:3,atk:1,spd:3};
 battleUI.classList.remove("hidden");
 log("ğŸ¦‡ ë°•ì¥ ë“±ì¥!");
 if(monster.spd>player.spd) monsterAttack();
 update();
}
function spawnMimic(){
 monster={name:"ë¯¸ë¯¹",hp:5,atk:2,spd:99};
 battleUI.classList.remove("hidden");
 log("ğŸ˜ˆ ë¯¸ë¯¹ ë“±ì¥!");
 monsterAttack();
 update();
}

/* ===== ì „íˆ¬ ===== */
atkBtn.onclick=()=>{
 monster.hp-=player.atk;
 if(monster.hp<=0){win();return;}
 monsterAttack();
};
escBtn.onclick=()=>{
 if(Math.floor(Math.random()*6)+1<=4) monsterAttack();
 else win();
};
function monsterAttack(){
 player.hp-=monster.atk;
 if(player.hp<=0){die();return;}
 update();
}

/* ===== ì „ë¦¬í’ˆ ===== */
function dropLoot(mon){
 let d=Math.floor(Math.random()*6)+1;
 if(mon.name==="ë°•ì¥"){
  if(d<=4){inventory.push("batWing");log("ğŸ¦‡ ë°•ì¥ë‚ ê°œ íšë“");}
  else{gold+=2;log("ğŸ’° ê³¨ë“œ 2 íšë“");}
 }
 if(mon.name==="ë¯¸ë¯¹"){
  gold+=2; log("ğŸ’° ë¯¸ë¯¹ì—ê²Œì„œ ê³¨ë“œ 2 íšë“");
 }
}

/* ===== ìŠ¹ë¦¬ ===== */
function win(){
 log(`${monster.name} ì²˜ì¹˜`);
 dropLoot(monster);
 monster=null;
 battleUI.classList.add("hidden");
 turn++;
 if(turn>=5){turn=0;isDay=!isDay;if(isDay)day++;}
 update();
}

/* ===== ì‚¬ë§ ===== */
function die(){
 game.classList.add("hidden");
 deadUI.classList.remove("hidden");
 deadInfo.innerHTML=`${day}ì¼ì§¸<br>${monster.name}ì—ê²Œ ì‚¬ë§`;
}

/* ===== UI ===== */
function update(){
 document.body.className=isDay?"day":"night";
 timeUI.textContent=isDay?"ğŸŒ DAY":"ğŸŒ™ NIGHT";
 dayUI.textContent=day;
 pHp.textContent=player.hp;
 pAtk.textContent=player.atk;
 pSpd.textContent=player.spd;
 mInfo.textContent=monster?`${monster.name} HP:${monster.hp}`:"ì—†ìŒ";
 goldUI.textContent=gold;
 rubyUI.textContent=ruby;
 invUI.textContent=items.branch.count>0?`ë‚˜ë­‡ê°€ì§€:${items.branch.count}`:"ì—†ìŒ";
}
function log(t){document.getElementById("log").innerHTML=t;}

updateStatUI();
</script>
</body>
</html>
