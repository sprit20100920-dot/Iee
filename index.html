<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Pixel Rogue RPG</title>
<style>
body {
  margin: 0;
  background: #111;
  color: white;
  font-family: sans-serif;
  text-align: center;
}
canvas {
  background: black;
  display: block;
  margin: auto;
  border: 2px solid #555;
}
button {
  font-size: 18px;
  margin: 5px;
}
</style>
</head>
<body>

<h2 id="title">스탯 분배 (총 12)</h2>

<div id="statUI">
  스피드: <span id="speed">0</span>
  <button onclick="changeStat('speed',1)">+</button>
  <button onclick="changeStat('speed',-1)">-</button><br>

  체력: <span id="hp">0</span>
  <button onclick="changeStat('hp',1)">+</button>
  <button onclick="changeStat('hp',-1)">-</button><br>

  공격: <span id="atk">0</span>
  <button onclick="changeStat('atk',1)">+</button>
  <button onclick="changeStat('atk',-1)">-</button><br>

  <p>남은 포인트: <span id="points">12</span></p>
  <button onclick="startGame()">게임 시작</button>
</div>

<canvas id="game" width="900" height="600" style="display:none;"></canvas>

<div id="battleUI" style="display:none;">
  <button onclick="attack()">공격</button>
</div>

<script>
/* =====================
   기본 데이터
===================== */
let totalPoints = 12;

let player = {
  speed: 0,
  atk: 0,
  maxHp: 0,
  hp: 0
};

let monster = {};
let turn = 1;
let turnInPhase = 1;
let isDay = true;

const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

/* =====================
   스탯 분배
===================== */
function changeStat(stat, value) {
  if (value > 0 && totalPoints === 0) return;
  if (value < 0 && player[stat] === 0) return;

  player[stat] += value;
  totalPoints -= value;

  document.getElementById(stat === 'speed' ? 'speed' : stat).innerText = player[stat];
  document.getElementById('points').innerText = totalPoints;
}

function startGame() {
  if (totalPoints !== 0) {
    alert("포인트를 모두 사용하세요!");
    return;
  }

  player.maxHp = player.hp * 10;
  player.hp = player.maxHp;

  document.getElementById("statUI").style.display = "none";
  document.getElementById("title").style.display = "none";
  canvas.style.display = "block";
  document.getElementById("battleUI").style.display = "block";

  nextMonster();
  draw();
}

/* =====================
   몬스터 생성
===================== */
function nextMonster() {
  monster = {
    maxHp: isDay ? 30 : 50,
    hp: isDay ? 30 : 50,
    atk: isDay ? 5 : 10
  };
}

/* =====================
   전투
===================== */
function attack() {
  // 플레이어 공격
  monster.hp -= player.atk;

  // 몬스터 반격
  if (monster.hp > 0) {
    player.hp -= monster.atk;
  }

  // 전투 종료
  if (monster.hp <= 0 || player.hp <= 0) {
    endBattle();
  }

  draw();
}

function endBattle() {
  turn++;
  turnInPhase++;

  if (turnInPhase > 5) {
    isDay = !
      function move(dir) {
  console.log("방향 버튼 입력:", dir);

  // 현재는 이동 없음
  // 이후 활용 예:
  // dir === 'left'  → 타겟 변경
  // dir === 'right' → 타겟 변경
  // dir === 'up'    → 메뉴 위
  // dir === 'down'  → 메뉴 아래
