<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Pixel Rogue RPG</title>
<style>
body {
  background:#111;
  color:white;
  font-family:sans-serif;
  text-align:center;
}
#gameBox {
  width:900px;
  margin:auto;
  border:2px solid #555;
  background:black;
}
#topBar {
  padding:8px;
  border-bottom:2px solid #444;
  font-size:20px;
}
#statusBar {
  display:flex;
  justify-content:space-between;
  padding:10px;
}
.panel {
  width:45%;
  border:1px solid #444;
  padding:8px;
}
#battleLog {
  border-top:2px solid #333;
  padding:10px;
  min-height:60px;
}
#bottomBar {
  display:flex;
  justify-content:space-between;
  padding:10px;
}
#controlUI button {
  width:60px;
  height:60px;
  font-size:26px;
}
button {
  font-size:16px;
  margin:4px;
}
.selected {
  background:#4caf50;
}
</style>
</head>
<body>

<!-- ===== ì‹œì‘ í™”ë©´ ===== -->
<div id="startUI">
  <h2>ìŠ¤íƒ¯ ë¶„ë°° (ì´ 12)</h2>

  <p>ìŠ¤í”¼ë“œ:
    <span id="spd">0</span>
    <button onclick="stat('spd',1)">+</button>
    <button onclick="stat('spd',-1)">-</button>
  </p>

  <p>ì²´ë ¥:
    <span id="hpStat">0</span>
    <button onclick="stat('hp',1)">+</button>
    <button onclick="stat('hp',-1)">-</button>
  </p>

  <p>ê³µê²©:
    <span id="atkStat">0</span>
    <button onclick="stat('atk',1)">+</button>
    <button onclick="stat('atk',-1)">-</button>
  </p>

  <p>ë‚¨ì€ í¬ì¸íŠ¸: <span id="pt">12</span></p>
  <button onclick="startGame()">ê²Œì„ ì‹œì‘</button>
</div>

<!-- ===== ê²Œì„ í™”ë©´ ===== -->
<div id="gameBox" style="display:none;">

  <div id="topBar">ğŸŒ DAY</div>

  <div id="statusBar">
    <div class="panel">
      <b>PLAYER</b><br>
      ì²´ë ¥: <span id="pHp"></span><br>
      ê³µê²©: <span id="pAtk"></span><br>
      ìŠ¤í”¼ë“œ: <span id="pSpd"></span>
    </div>

    <div class="panel">
      <b>MONSTER</b><br>
      <span id="mInfo">ì—†ìŒ</span>
    </div>
  </div>

  <div id="battleLog">íƒí—˜ì„ ì‹œì‘í–ˆë‹¤.</div>

  <div id="bottomBar">
    <div id="controlUI">
      <button onclick="move()">â¬†ï¸</button><br>
      <button onclick="move()">â¬…ï¸</button>
      <button onclick="move()">â¬‡ï¸</button>
      <button onclick="move()">â¡ï¸</button>
    </div>

    <div>
      <button onclick="toggleInv()">ğŸ’ ì¸ë²¤í† ë¦¬</button><br>
      <button onclick="resetGame()">â® ì²˜ìŒìœ¼ë¡œ</button>
    </div>
  </div>
</div>

<!-- ===== ì¸ë²¤í† ë¦¬ ===== -->
<div id="invUI" style="display:none;">
  <h3>ğŸ’ ì¸ë²¤í† ë¦¬</h3>
  <p id="goldText"></p>
  <div id="items"></div>
  <p id="desc"></p>
  <button onclick="useItem()">ì‚¬ìš©</button>
  <button onclick="toggleInv()">ë‹«ê¸°</button>
</div>

<!-- ===== íŒ¨ë°° ===== -->
<div id="gameOverUI" style="display:none;">
  <h1>ğŸ’€ íŒ¨ë°°</h1>
  <button onclick="resetGame()">ë‹¤ì‹œ ì‹œì‘</button>
</div>

<script>
/* ===== ì´ˆê¸° ìƒíƒœ ===== */
let statPt = 12;
let stats = { spd:0, hp:0, atk:0 };

let player, monster = null;
let inBattle = false;

let time = { day:true, turn:0 };
let inventory = [];
let cursor = 0;
let gold = 0;

/* ===== ì´ˆê¸° UI ê°•ì œ ì„¸íŒ… ===== */
document.getElementById("spd").innerText = 0;
document.getElementById("hpStat").innerText = 0;
document.getElementById("atkStat").innerText = 0;
document.getElementById("pt").innerText = statPt;

/* ===== ìŠ¤íƒ¯ ë¶„ë°° ===== */
function stat(k,v){
  if(statPt - v < 0) return;
  if(stats[k] + v < 0) return;

  stats[k] += v;
  statPt -= v;

  document.getElementById("spd").innerText = stats.spd;
  document.getElementById("hpStat").innerText = stats.hp;
  document.getElementById("atkStat").innerText = stats.atk;
  document.getElementById("pt").innerText = statPt;
}

/* ===== ê²Œì„ ì‹œì‘ ===== */
function startGame(){
  if(statPt > 0){
    alert("í¬ì¸íŠ¸ë¥¼ ëª¨ë‘ ì‚¬ìš©í•˜ì„¸ìš”");
    return;
  }

  player = {
    hp: stats.hp + 10,
    atk: stats.atk + 1,
    spd: stats.spd
  };

  document.getElementById("startUI").style.display = "none";
  document.getElementById("gameBox").style.display = "block";
  updateUI();
}

/* ===== ë¦¬ì…‹ ===== */
function resetGame(){
  location.reload();
}

/* ===== íƒí—˜ ===== */
function move(){
  if(inBattle) return;

  // ë¬´ì¡°ê±´ ëª¬ìŠ¤í„° or ìƒì
  if(Math.random() < 0.6){
    spawnMonster();
  } else {
    openChest();
  }
}

/* ===== ëª¬ìŠ¤í„° ===== */
function spawnMonster(){
  monster = {
    hp: time.day ? 6 : 9,
    atk: time.day ? 2 : 4,
    spd: 1
  };
  inBattle = true;
  log("ëª¬ìŠ¤í„°ê°€ ë‚˜íƒ€ë‚¬ë‹¤!");
  battleTurn();
}

/* ===== ì „íˆ¬ í„´ ===== */
function battleTurn(){
  if(player.spd >= monster.spd){
    monster.hp -= player.atk;
    if(monster.hp <= 0) return winBattle();
    player.hp -= monster.atk;
  } else {
    player.hp -= monster.atk;
    if(player.hp <= 0) return gameOver();
    monster.hp -= player.atk;
  }

  if(player.hp <= 0) return gameOver();
  updateUI();
}

/* ===== ìŠ¹ë¦¬ ===== */
function winBattle(){
  log("ëª¬ìŠ¤í„°ë¥¼ ì“°ëŸ¬ëœ¨ë ¸ë‹¤!");
  monster = null;
  inBattle = false;

  time.turn++;
  if(time.turn >= 5){
    time.turn = 0;
    time.day = !time.day;
  }

  updateUI();
}

/* ===== ìƒì ===== */
function openChest(){
  let d = Math.floor(Math.random()*6) + 1;

  if(d <= 2){
    inventory.push({ name:"ë‚˜ë­‡ê°€ì§€", desc:"+1 ê³µê²©" });
    log("ë‚˜ë­‡ê°€ì§€ë¥¼ ì–»ì—ˆë‹¤!");
  }
  else if(d <= 4){
    gold++;
    log("ê³¨ë“œë¥¼ ì–»ì—ˆë‹¤!");
  }
  else {
    monster = { hp:1, atk:1, spd:99 };
    inBattle = true;
    log("ë¯¸ë¯¹ì´ë‹¤!");
    battleTurn();
  }

  updateUI();
}

/* ===== ì¸ë²¤í† ë¦¬ ===== */
function toggleInv(){
  let ui = document.getElementById("invUI");
  ui.style.display = ui.style.display === "block" ? "none" : "block";
  renderInv();
}
function renderInv(){
  document.getElementById("goldText").innerText = "ğŸ’° " + gold;
  let el = document.getElementById("items");
  el.innerHTML = "";

  inventory.forEach((it,i)=>{
    let d = document.createElement("div");
    d.innerText = (i===cursor?"â–¶ ":"  ") + it.name;
    if(i===cursor) d.className="selected";
    el.appendChild(d);
  });

  document.getElementById("desc").innerText =
    inventory[cursor]?.desc || "";
}
function useItem(){
  let it = inventory[cursor];
  if(!it) return;

  if(it.name==="ë‚˜ë­‡ê°€ì§€") player.atk++;

  inventory.splice(cursor,1);
  cursor = 0;
  renderInv();
}

/* ===== íŒ¨ë°° ===== */
function gameOver(){
  document.getElementById("gameBox").style.display="none";
  document.getElementById("gameOverUI").style.display="block";
}

/* ===== UI ===== */
function updateUI(){
  document.getElementById("topBar").innerText =
    time.day ? "ğŸŒ DAY" : "ğŸŒ™ NIGHT";

  document.getElementById("pHp").innerText = player.hp;
  document.getElementById("pAtk").innerText = player.atk;
  document.getElementById("pSpd").innerText = player.spd;

  document.getElementById("mInfo").innerText =
    monster ? `ì²´ë ¥:${monster.hp} ê³µê²©:${monster.atk}` : "ì—†ìŒ";
}
function log(t){
  document.getElementById("battleLog").innerText = t;
}
</script>
</body>
</html>
